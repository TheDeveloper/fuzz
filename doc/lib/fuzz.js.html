<!DOCTYPE html>
<html>
<head>
  <title>fuzz.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-script.js"></script>
</head>
<body>
  <div id="tree_wrapper">
    <div id="tree"></div>
  </div>
  <div id="tree-toggle"></div>
  <div id="container"><div id="background"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>

        </td>
        <td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">amqp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;amqp&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">debug</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)(</span><span class="s1">&#39;fuzz&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">eventHandlers</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./eventHandlers&#39;</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">fuzz</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">connection</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">defaultConfig</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">rabbitMQ</span><span class="p">;</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">connected</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">eventHandlers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">eventHandlers</span><span class="p">(</span><span class="nx">self</span><span class="p">);</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Establish an amqp connection.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>-</span>
      <span class="dox_type">conf</span>
      <span>amqp configuration object</span>
    </div>
    <div class="dox_tag_detail">
      <span>-</span>
      <span class="dox_type">cb</span>
      <span>callback to fire when the amqp triggers the 'ready' event</span>
    </div>
  </div>
</div>
        </td>
        <td class="code"><div class="highlight"><pre><span class="nx">fuzz</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">conf</span><span class="p">,</span> <span class="nx">cb</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">conf</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">cb</span> <span class="o">=</span> <span class="nx">conf</span><span class="p">;</span>
    <span class="nx">conf</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">connection</span><span class="p">){</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>If rabbit connection already exists, close it</p>
        </td>
        <td class="code"><div class="highlight"><pre>    <span class="nx">self</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span> <span class="c1">// Will trigger the &#39;close&#39; event, invoking the eventHandler for close</span>
  <span class="p">}</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">connection</span> <span class="o">=</span> <span class="nx">amqp</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">conf</span> <span class="o">||</span> <span class="nx">config</span><span class="p">.</span><span class="nx">rabbitmq</span><span class="p">);</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>Set up internal event handlers. Each handler function name matches an amqp event</p>
        </td>
        <td class="code"><div class="highlight"><pre>  <span class="nx">self</span><span class="p">.</span><span class="nx">eventHandlers</span><span class="p">.</span><span class="nx">wireEvents</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">connection</span><span class="p">);</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">connection</span><span class="p">);</span>
  <span class="p">});</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">cb</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
  <script>
    makeTree({"files":["config.js","README.md"],"dirs":{"config":{"files":["default.js"]},"lib":{"files":["eventHandlers.js","fuzz.js"]},"test":{"files":["fuzz.js"]},"node_modules":{"dirs":{"amqp":{"files":["amqp-definitions-0-9-1.js","amqp.js","History.md","jspack.js","promise.js","README.md","test.js"],"dirs":{"test":{"files":["harness.js","test-auto-delete-queue.js","test-basic-return.js","test-buffer.js","test-connection-callbacks.js","test-default-exchange.js","test-destroy-close-delete.js","test-ex-and-q-deletions.js","test-exchange-callbacks.js","test-headers.js","test-heartbeat.js","test-json.js","test-large-body.js","test-parser.js","test-properties.js","test-queue-args.js","test-queue-creation.js","test-reject.js","test-shift.js","test-simple.js","test-type-and-headers.js","test-unbind.js","test-unsubscribe.js"]},"util":{"files":["delete-exchange.js","delete-queue.js"]}}},"config":{"files":["History.md","README.md"],"dirs":{"doc":{"files":["classmap.js"]},"lib":{"files":["config.js"]},"test":{"files":["1-protected-test.js","2-config-test.js"],"dirs":{"config":{"files":["default.js"]}}},"node_modules":{"dirs":{"js-yaml":{"files":["HISTORY.md","index.js","README.md"],"dirs":{"doc":{"files":["gotchas.md"]},"examples":{"files":["single.js"]},"lib":{"files":["js-yaml.js"],"dirs":{"js-yaml":{"files":["common.js","composer.js","constructor.js","errors.js","events.js","loader.js","nodes.js","parser.js","reader.js","resolver.js","scanner.js","tokens.js"]}}},"test":{"files":["functional-test.js","helper.js","issues-test.js"],"dirs":{"functional":{"files":["canonical.js","functional-errors.js","functional-resolver.js","functional-structure.js","functional-tokens.js"]},"issues":{"files":["issue-17.js","issue-19.js","issue-26.js","issue-33.js","issue-8.js","issue-9.js"]}}}}},"vows":{"files":["README.md"],"dirs":{"lib":{"files":["vows.js"],"dirs":{"assert":{"files":["error.js","macros.js","utils.js"]},"vows":{"files":["console.js","context.js","extras.js","suite.js"],"dirs":{"coverage":{"files":["file.js","report-html.js","report-json.js","report-plain.js","report-xml.js"]},"reporters":{"files":["dot-matrix.js","json.js","silent.js","spec.js","watch.js","xunit.js"]}}}}},"test":{"files":["assert-test.js","isolate-test.js","supress-stdout-test.js","vows-error-test.js","vows-test.js","vows_underscore_test.js","VowsCamelCaseTest.js"],"dirs":{"fixtures":{"dirs":{"isolate":{"files":["failing.js","log.js","passing.js","stderr.js"]},"supress-stdout":{"files":["output.js"]}}}}},"node_modules":{"dirs":{"eyes":{"files":["README.md"],"dirs":{"lib":{"files":["eyes.js"]},"test":{"files":["eyes-test.js"]}}}}}}},"coffee-script":{"dirs":{"lib":{"dirs":{"coffee-script":{"files":["browser.js","cake.js","coffee-script.js","command.js","grammar.js","helpers.js","index.js","lexer.js","nodes.js","optparse.js","parser.js","repl.js","rewriter.js","scope.js"]}}}}}}}}},"debug":{"files":["debug.component.js","debug.js","head.js","History.md","index.js","Readme.md","tail.js"],"dirs":{"example":{"files":["app.js","wildcards.js","worker.js"]},"lib":{"files":["debug.js"]}}},"docker":{"files":["History.md","README.md"],"dirs":{"lib":{"files":["showdown.js"]},"res":{"files":["script.js"]},"src":{"files":["docker.js"]},"node_modules":{"dirs":{"commander":{"files":["History.md","index.js","Readme.md"],"dirs":{"lib":{"files":["commander.js"]}}},"dox":{"files":["History.md","index.js","Readme.md"],"dirs":{"lib":{"files":["dox.js","utils.js"]},"node_modules":{"dirs":{"commander":{"files":["History.md","index.js","Readme.md"],"dirs":{"lib":{"files":["commander.js"]}}},"github-flavored-markdown":{"files":["index.md","preview.md","README.md"],"dirs":{"scripts":{"files":["preview.js","showdown.js"]}}}}}}},"mkdirp":{"files":["index.js","README.markdown"],"dirs":{"examples":{"files":["pow.js"]},"test":{"files":["chmod.js","clobber.js","mkdirp.js","perm.js","perm_sync.js","race.js","rel.js","return.js","return_sync.js","sync.js","umask.js","umask_sync.js"]}}},"watchr":{"dirs":{"lib":{"files":["bin.js","watchr.js"]},"node_modules":{"dirs":{"bal-util":{"files":["History.md","main.js","README.md"],"dirs":{"node_modules":{"dirs":{"request":{"files":["aws.js","aws2.js","forever.js","main.js","mimetypes.js","oauth.js","README.md","tunnel.js","uuid.js"],"dirs":{"tests":{"files":["run.js","server.js","test-body.js","test-cookie.js","test-cookiejar.js","test-defaults.js","test-errors.js","test-headers.js","test-httpModule.js","test-https-strict.js","test-https.js","test-oauth.js","test-params.js","test-pipes.js","test-pool.js","test-proxy.js","test-qs.js","test-redirect.js","test-s3.js","test-timeout.js","test-toJSON.js","test-tunnel.js"],"dirs":{"ssl":{"dirs":{"ca":{"files":["server.js"]}}}}},"vendor":{"dirs":{"cookie":{"files":["index.js","jar.js"]}}}}},"coffee-script":{"dirs":{"lib":{"dirs":{"coffee-script":{"files":["browser.js","cake.js","coffee-script.js","command.js","grammar.js","helpers.js","index.js","lexer.js","nodes.js","optparse.js","parser.js","repl.js","rewriter.js","scope.js"]}}}}}}}}}}}}}}}}}}}}}, '../', 'lib/fuzz.js');
  </script>
</body>
</html>
